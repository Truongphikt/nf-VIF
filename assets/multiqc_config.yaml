#
# HPV config for MultiQC
#
#################################################################

title: HPV Genotyping 
subtitle: Institut Curie NGS/bioinformatics platform
intro_text: >
   This report has been generated by the HPV analysis pipeline.
custom_logo_title: Institut Curie
skip_generalstats: true

read_count_multiplier: 0.000001
read_count_prefix: 'M'
read_count_desc: 'millions'

custom_data:
    ctrl_stats:
        file_format: 'tsv'
        section_name: 'Capture Controls'
        description: ' on known genomic regions.'
        plot_type: 'bargraph'
        pconfig:
            namespace: 'ctrlstats'
            title: 'Controls'
            id: 'ctrlstats'
            cpswitch_c_active: false

    hpv_stats:
        file_format: 'tsv'
        section_name: 'HPV Genotyping'
        description: ' from available HPV strains. Sequencing reads were aligned on the complete HPV database.'
        plot_type: 'bargraph'
        pconfig:
            namespace: 'hpvstats'
            title: 'HPV Genotypes'
            id: 'hpvstats'
            cpswitch_c_active: false

    hpv_loc_stats:
        file_format: 'csv'
        section_name: 'HPV Local Alignment'
        description: ' from detected subtypes.'
        plot_type: 'table'
        pconfig:
            namespace: 'hpvlocstats'
            title: 'Aligned reads on HPV genome(s)'
            id: 'hpvlocstats'
            scale: 'RdYlBu'
            format: '{:.0f}'
            save_file: true

    insertion_summary:
        file_format: 'csv'
        section_name: 'Insertion Sites'
        description: ' detected on Human reference genome. <b>CountHQ</b> report the number of high quality BLAT reads at the breakpoint position. 
	<b>Count</b> reports the number of reads detected with breakpoint motif (regardless the BLAT results). The <b>score</b> is calculated as follow: <b>+1</b> if two
	breakpoints in both orientation are detected on the same chromosome / <b>+3</b> if at least two reads support the breakpoints / <b>+6</b> if the read is uniquely 
	aligned at the breakpoint position. The mean score per breakpoint is reported.'
        plot_type: 'table'
        pconfig:
            namespace: 'insertion_summary'
            title: 'Insertion Sites'
            id: 'insertionsites'
            save_file: true
            no_beeswarm: true
            col1_header: 'IDs'
        headers:
            sample:
              title: 'Sample Name'
              scale: false
              format: '{:.0f}'
              placement: 1000
            genotype:
              title: 'HPV Genotype'
              scale: false
              format: '{:.0f}'
              placement: 2000
            feature:
              title: 'Clipping'
              description: 'Clipped part of the reads (5/3 ends)'
              scale: false
              format: '{:.0f}'
              placement: 3000
              hidden: true
            virus_bkp_orientation:
              title: 'HPV Orientation'
              description: 'HPV reads strand'
              scale: false
              format: '{:.0f}'
              placement: 4000
            score:
              title: 'Score'
              min: 0
              max: 10
              scale: 'YlOrBr'
              format: '{:.0f}'
              placement: 5000
            virus_bkp_pos:
              title: 'HPV Position'
              scale: false
              format: '{:.0f}'
              placement: 6000
            human_bkp_chr:
              title: 'Chromosome'
              scale: false
              format: '{:.0f}'
              placement: 7000
            human_bkp_pos:
              title: 'Breakpoint'
              scale: false
              format: '{:.0f}'
              placement: 8000
            human_end:
              title: 'Reads Ends'
              description: Max reads end positions
              scale: false
              format: '{:.0f}'
              placement: 9000
            human_orientation:
              title: 'Orientation'
              description: 'human reads strand'
              scale: false
              placement: 10000
            match:
              title: 'Match'
              description: 'Number of matching bases that are not repeats'
              scale: false
              format: '{:.0f}'
              placement: 11000
              hidden: true
            countHQ:
              title: 'CountsHQ'
              description: 'Number of high-quality reads aligned with a good quality at the breakpoint position'
              scale: 'YlOrBr'
              format: '{:.0f}'
              placement: 12000
            count:
              title: 'Counts'
              description: 'Number of reads with a motif suporting the breakpoint'
              scale: 'YlOrBr'
              format: '{:.0f}'
              placement: 13000
              hidden: true
            motif:
              title: 'HPV/Human motif'
              description: 'Motif junction between HPV and Human genomes'
              scale: false
              format: '{:.0f}'
              placement: 14000
              hidden: true
            max_flanking_seq:
              title: "Flanking sequence"
              description: "Longest Human flanking sequence at breakpoint"
              scale: false
              format: '{:.0f}'
              placement: 15000  
              hidden: true


sp:
   ctrl_stats:
      fn: '*ctrl.stats'
   hpv_stats:
      fn: '*genotyping.stats'
   hpv_loc_stats:
      fn: '*coverage.stats'
   insertion_summary:
      fn: '*table_filtered.csv'

module_order:
  - fastqc

report_section_order:
  ctrl_stats:
    order: -100
  hpv_stats:
    order: -200
  hpv_loc_stats:
    order: -300
  insertion_summary:
    order: -900
  software_versions:
    order: -1001
  summary:
    order: -1100

table_columns_visible:
    FastQC:
        percent_duplicates: False
    hpvlocstats:
        bam: False
        max_cov: False


table_cond_formatting_rules:
    score:
        pass:
            - gt: 7.99
        warn:
            - lt: 8
        fail:
            - lt: 4

custom_plot_config:
    # Show the percentages tab by default for the FastQC sequence counts plot
    fastqc_sequence_counts_plot:
        cpswitch_c_active: False


plots_force_interactive: True

fn_clean_exts:
    - '_ctrl.stats'
    - '_HPVgenotyping.stats'
    - '_covmatrix.mqc'
    - '_bkp.mqc'
    - '_table_filtered.csv'
